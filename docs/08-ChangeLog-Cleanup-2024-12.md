# ุณุฌู ุงูุชุบููุฑุงุช - ูุฑุงุฌุนุฉ ูุชูุธูู ุงูููุฏ

> **ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: 2025-12-14  
> **ุงูุฅุตุฏุงุฑ**: v2.1

---

## ๐ ููุฎุต ุงูุชุบููุฑุงุช

ุชู ุฅุฌุฑุงุก ูุฑุงุฌุนุฉ ุดุงููุฉ ูููุธุงู ูุชูุธูู ุงูููุฏ ูุน ุงูุชุฑููุฒ ุนูู:
1. ุฅุฒุงูุฉ ุงููุงุฌูุงุช ูุงููุณุงุฑุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ
2. ุชูุญูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช
3. ุฅุตูุงุญ ุงูุฃุฎุทุงุก ุงูููุชุดูุฉ
4. ุชุญุณูู ุงูุชูุซูู

---

## ๐ ุงููุงุฌูุงุช ุงููุชุงุญุฉ (ุงูุญุงููุฉ)

| ุงููุณุงุฑ | ุงูุตูุญุฉ | ุงููุตู |
|--------|--------|-------|
| `/` | `decision.html` | ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ - ุงุชุฎุงุฐ ุงููุฑุงุฑ |
| `/settings` | `settings.html` | ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช |

### ุงููุงุฌูุงุช ุงูููุฒุงูุฉ (Deprecated)

| ุงููุณุงุฑ | ุงูุณุจุจ |
|--------|-------|
| `/records` | ูููุฑุฑ - ุชู ุงุณุชุจุฏุงูู ุจู `/` |
| `/decision` | ูููุฑุฑ - ุชู ุงุณุชุจุฏุงูู ุจู `/` |
| `/dictionary` | ูุงุฌูุฉ ูุฏููุฉ - ุชู ุฏูุฌ ูุธุงุฆููุง ูู ุตูุญุฉ ุงููุฑุงุฑ |
| `/import` | ูุงุฌูุฉ ูุฏููุฉ - ุชู ุฏูุฌ ุงูุงุณุชูุฑุงุฏ ูู ุตูุญุฉ ุงููุฑุงุฑ |

---

## ๐ ุงููููุงุช ุงูููุนุฏููุฉ

### 1. `www/index.php` (Router)

**ุงูุชุบููุฑุงุช:**
- ุชุจุณูุท ูุณุงุฑุงุช ุงูุตูุญุงุช: `/` ู `/settings` ููุท
- ุญุฐู ูุณุงุฑุงุช `/records`ุ `/decision`ุ `/dictionary`ุ `/import`
- ุญุฐู ูุณุงุฑุงุช API ุบูุฑ ูุณุชุฎุฏูุฉ:
  - `DELETE /api/dictionary/suppliers/{id}`
  - `DELETE /api/dictionary/banks/{id}`
  - `GET/POST/DELETE /api/dictionary/.../alternatives`
- ุฅุถุงูุฉ ุชุนูููุงุช ุชูุซูููุฉ

### 2. `www/decision.html`

**ุงูุชุบููุฑุงุช:**
- ุชุญุฏูุซ ูุงุฆูุฉ ุงูุชููู: ุฑุงุจุทูู ููุท (ุงูุฑุฆูุณูุฉุ ุงูุฅุนุฏุงุฏุงุช)
- ุฅุฒุงูุฉ ุฑุงุจุท `/decision` ุงูุฒุงุฆุฏ

### 3. `www/settings.html`

**ุงูุชุบููุฑุงุช:**
- ุชุบููุฑ ูุต "ุงูุณุฌูุงุช" ุฅูู "ุงูุฑุฆูุณูุฉ"
- ุงูุฑุงุจุท ูุดูุฑ ุฅูู `/`

### 4. `app/Support/Logger.php`

**ุงูุชุบููุฑุงุช:**
- ุฏุงูุฉ `info()` ุฃุตุจุญุช ุชุฏุนู `$context` ูุซู `error()`
```php
public static function info(string $message, array $context = []): void
```

### 5. `app/Services/CandidateService.php`

**ุงูุชุบููุฑุงุช:**
- ุฅุถุงูุฉ ุชุนููู ุชูุซููู ุดุงูู ููุนุชุจุงุช ุงูุซูุงุซ (Thresholds) ูู ุฏุงูุฉ `supplierCandidates()`
- ูุดุฑุญ ุงููุฑู ุจูู `MATCH_AUTO_THRESHOLD` ู `MATCH_WEAK_THRESHOLD` ู `MATCH_REVIEW_THRESHOLD`

### 6. `app/Services/AutoAcceptService.php`

**ุงูุชุบููุฑุงุช:**
- ุฅุถุงูุฉ ุชุนููู ููุถุญ ุฃู ุงุณุชุฏุนุงุก `updateDecision` ูุฑุชูู ููุตูุฏ
- ุงูุฃูู: ุชุญุฏูุซ `supplier_id` + `match_status`
- ุงูุซุงูู: ุฅุถุงูุฉ `decision_result` ุจุนุฏ ูุฌุงุญ `learning_log`

### 7. `app/Controllers/DictionaryController.php`

**ุงูุชุบููุฑุงุช:**
- ุฅุตูุงุญ `updateBank()`: ุชุบููุฑ ููุน `$id` ูู `string` ุฅูู `int`

---

## ๐ API Endpoints ุงููุชุงุญุฉ

### ูุณุชุฎุฏูุฉ ูู ุตูุญุฉ ุงููุฑุงุฑ:

| Method | Endpoint | ุงููุตู |
|--------|----------|-------|
| GET | `/api/records` | ุฌูุจ ุงูุณุฌูุงุช |
| GET | `/api/records/{id}/candidates` | ุฌูุจ ุงููุฑุดุญูู ููุณุฌู |
| POST | `/api/records/{id}/decision` | ุญูุธ ุงููุฑุงุฑ |
| POST | `/api/import/excel` | ุงุณุชูุฑุงุฏ ููู Excel |
| GET | `/api/dictionary/suppliers` | ุฌูุจ ุงูููุฑุฏูู (ููู autocomplete) |
| GET | `/api/dictionary/banks` | ุฌูุจ ุงูุจููู (ููู autocomplete) |
| POST | `/api/dictionary/suppliers` | ุฅุถุงูุฉ ููุฑุฏ ุฌุฏูุฏ |
| POST | `/api/dictionary/suggest-alias` | ุงูุชุฑุงุญ alias |

### ูุณุชุฎุฏูุฉ ูู ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช:

| Method | Endpoint | ุงููุตู |
|--------|----------|-------|
| GET | `/api/settings` | ุฌูุจ ุงูุฅุนุฏุงุฏุงุช |
| POST | `/api/settings` | ุญูุธ ุงูุฅุนุฏุงุฏุงุช |
| POST | `/api/settings/backup` | ูุณุฎ ุงุญุชูุงุทู |
| POST | `/api/settings/export-dictionary` | ุชุตุฏูุฑ ุงููุงููุณ |
| POST | `/api/settings/import-dictionary` | ุงุณุชูุฑุงุฏ ุงููุงููุณ |

---

## โ๏ธ ููุงุญุธุงุช ูููุทูุฑูู

1. **ูุง ุชูุถู ูุณุงุฑุงุช ุตูุญุงุช ุฌุฏูุฏุฉ** ุฅูุง ุจุนุฏ ูุฑุงุฌุนุฉ ุงููุฑูู
2. **API endpoints** ุชุณุชุฎุฏู ูููุฉ `dictionary` ูู ุงููุณุงุฑ ูุฃุณุจุงุจ ุชุงุฑูุฎูุฉุ ููููุง ุชุฎุฏู ุตูุญุฉ ุงููุฑุงุฑ
3. **ุงูุญุฐู ูุงูุชุนุฏูู**: ูุง ููุฌุฏ ุญุฐู ููููุฑุฏูู/ุงูุจููู ูู ุงููุงุฌูุฉ (ุจุงูุชุตููู)
4. **ุงูุงุณู ุงูุจุฏูู (Alternatives)**: ูุชู ุชุณุฌูููุง ุชููุงุฆูุงู ูู ุฎูุงู ูุธุงู ุงูุชุนููุ ููุณุช ูุงุฌูุฉ ูููุตูุฉ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

ุชู ุงุฎุชุจุงุฑ ุงูุชุงูู ุจูุฌุงุญ:
- โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ `/`
- โ ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช `/settings`
- โ ุงูุชููู ุจูู ุงูุตูุญุชูู
- โ `/dictionary` ูุนุทู 404 (ูุทููุจ)
- โ `/records` ูุนุทู 404 (ูุทููุจ)
