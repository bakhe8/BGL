# ุณุฌู ุงูุฃุญุฏุงุซ ุงูุฒููู (Timeline Events)

## ๐ ูุธุฑุฉ ุนุงูุฉ
ูุธุงู **Timeline Events** ูู ุงูููุจ ุงููุงุจุถ ููุดูุงููุฉ ูู ุงููุธุงู. ูููู ุจุชุชุจุน ูุชุณุฌูู ูู ุชุบููุฑ ูุทุฑุฃ ุนูู ุณุฌู ุงูุถูุงู ููุฐ ูุญุธุฉ ุงุณุชูุฑุงุฏู ูุญุชู ุงูุฅูุฑุงุฌ ุนูู.

ุณุงุจูุงูุ ูุงู ุงููุธุงู ูุญุชูุธ ููุท ุจู "ุงูุญุงูุฉ ุงูุญุงููุฉ". ุงูุขูุ ูุญุชูุธ ุงููุธุงู ุจู "ูุตุฉ ุญูุงุฉ" ูู ุถูุงู.

---

## ๐ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ
1.  **ุชุชุจุน ูุงูู (Full Audit Trail)**: ูุนุฑูุฉ ูู ูุงู ุจุงูุชุบููุฑุ ูุชูุ ููุง ูู ุงูููู ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ.
2.  **ุงูููุทุงุช ุงูุชุงุฑูุฎูุฉ (Snapshots)**: ุญูุธ ูุณุฎุฉ ูุงููุฉ ูู ุจูุงูุงุช ุงูุถูุงู ุนูุฏ ูู ุญุฏุซ ูุงู (ููุง ูุณูุญ ุจุฅุนุงุฏุฉ ุทุจุงุนุฉ ุงูุฎุทุงุจุงุช ููุง ูุงูุช ูู ุงููุงุถู).
3.  **ุงูุดูุงููุฉ**: ุชูุถูุญ ุงููุฑู ุจูู ุงูุจูุงูุงุช ุงููุงุฏูุฉ ูู Excel (ุงูุฎุงู) ูุงูุจูุงูุงุช ุงููุนุชูุฏุฉ ูู ุงููุธุงู.

---

## ๐ ุฃููุงุน ุงูุฃุญุฏุงุซ (Event Types)

| ุงูุญุฏุซ (Event) | ุงูุจุงุฏุฌ | ุงููุตู | ูุชู ูุญุฏุซุ |
|---------------|--------|-------|-----------|
| `import` | <span style="background:#e0e7ff; color:#3730a3; padding:2px 6px; border-radius:4px">ุงุณุชูุฑุงุฏ</span> | ุฅูุดุงุก ุงูุณุฌู ูุฃูู ูุฑุฉ | ุนูุฏ ุฑูุน ููู Excel |
| `status_change` | <span style="background:#dcfce7; color:#166534; padding:2px 6px; border-radius:4px">ูุทุงุจูุฉ</span> | ุฑุจุท ุงูุณุฌู ุจููุฑุฏ/ุจูู | ุนูุฏ ุงููุทุงุจูุฉ ุงูุขููุฉ ุฃู ุงููุฏููุฉ |
| `supplier_change` | โ๏ธ ุชุนุฏูู | ุชุบููุฑ ุงูููุฑุฏ ูุฏููุงู | ุนูุฏ ุชุนุฏูู ุงูููุฑุฏ ูู ูุงุฌูุฉ ุงููุฑุงุฑ |
| `extension` | <span style="background:#fef9c3; color:#854d0e; padding:2px 6px; border-radius:4px">ุชูุฏูุฏ</span> | ุชุณุฌูู ุชูุฏูุฏ ููุถูุงู | ุนูุฏ ุงูููุฑ ุนูู "ุชูุฏูุฏ" |
| `release` | <span style="background:#fee2e2; color:#991b1b; padding:2px 6px; border-radius:4px">ุฅูุฑุงุฌ</span> | ุฅููุงุก ุงูุถูุงู | ุนูุฏ ุฅุตุฏุงุฑ ุฎุทุงุจ ุฅูุฑุงุฌ |

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ (Architecture)

### ุชุฏูู ุงูุจูุงูุงุช (Data Flow)

```mermaid
graph TD
    Excel[ููู Excel] -->|ุงุณุชูุฑุงุฏ| ImportService
    ImportService -->|ุฅูุดุงุก| Repo[ImportedRecordRepository]
    
    Repo -->|ูู ูู ุฌุฏูุฏุ| Check{New Import?}
    Check -->|ูุนู| LogImport[ุชุณุฌูู ุญุฏุซ ุงุณุชูุฑุงุฏ]
    Check -->|ูุง| Skip
    
    LogImport -->|ุฃุฎุฐ ููุทุฉ| Snapshot[Capture Snapshot]
    Snapshot -->|ุญูุธ JSON| DB[(guarantee_timeline_events)]
```

### ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
ูุชู ุชุฎุฒูู ุงูุฃุญุฏุงุซ ูู ุฌุฏูู `guarantee_timeline_events`:

*   `guarantee_number`: ุฑูู ุงูุถูุงู (ุงูููุชุงุญ ุงูุฑุฆูุณู ููุชุฌููุน).
*   `event_type`: ููุน ุงูุญุฏุซ.
*   `snapshot_data`: ุนููุฏ ูุตู ูุญุชูู ุนูู ุจูุงูุงุช JSON ููุณุฌู ูู ุชูู ุงููุญุธุฉ.
*   `old_value` / `new_value`: ููุชุบููุฑุงุช ุงูุจุณูุทุฉ (ูุซู ุชุบููุฑ ูุจูุบ).

---

## ๐ธ ุขููุฉ ุงูููุทุงุช (Snapshots)

**ุงูููุทุฉ (Snapshot)** ูู ูุณุฎุฉ ูุฌูุฏุฉ ูู ุจูุงูุงุช ุงูุถูุงู.
*   **ููุงุฐุงุ** ูููุชุฑุถ ุฃู ุงุณู ุงูููุฑุฏ ุชุบูุฑ ุงูููู. ุฅุฐุง ุฃุฑุฏูุง ุทุจุงุนุฉ ุฎุทุงุจ ูุฏูู ุตุฏุฑ ูุจู ุดูุฑุ ูุฌุจ ุฃู ูุธูุฑ ุจุงูุงุณู ุงููุฏูู. ุงูููุทุงุช ุชุถูู ุฐูู.
*   **ูููุ** ูุชู ุชุฎุฒูู ุตู ุงูุณุฌู ูุงููุงู ูู JSON ุฏุงุฎู ุญุฏุซ ุงูู Timeline.

---

## ๐ ุฏูุฑุฉ ุญูุงุฉ ุงูุถูุงู (Lifecycle Example)

1.  **ุงูุงุณุชูุฑุงุฏ**: ูุชู ุฅูุดุงุก ุญุฏุซ `import`. ุงูุจูุงูุงุช ุชุธูุฑ ููุง ูู ูู Excel (ูุซูุงู: "SNB").
2.  **ุงููุทุงุจูุฉ**: ููุชุดู ุงููุธุงู ุฃู "SNB" ูู "ุงูุจูู ุงูุฃููู ุงูุณุนูุฏู". ูุชู ุฅูุดุงุก ุญุฏุซ `status_change` ููุถุญ ุงูุชุญูู ูู "SNB" โ "ุงูุจูู ุงูุฃููู".
3.  **ุงูุชุนุฏูู**: ููุงุญุธ ุงููุณุชุฎุฏู ุฎุทุฃ ูู ุงููุจูุบ ููุนุฏูู. ูุชู ุฅูุดุงุก ุญุฏุซ `amount_change`.
4.  **ุงูุฅูุฑุงุฌ**: ููุชูู ุงูุบุฑุถ ูู ุงูุถูุงู. ูููู ุงููุณุชุฎุฏู ุจุฅุตุฏุงุฑ ุฅูุฑุงุฌ. ูุชู ุฅูุดุงุก ุญุฏุซ `release` ููุชุญูู ุงูุณุฌู ููุฃุฑุดูู.
